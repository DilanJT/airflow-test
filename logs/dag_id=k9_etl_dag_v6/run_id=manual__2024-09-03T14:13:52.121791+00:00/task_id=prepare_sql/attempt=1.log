[2024-09-03T14:13:59.565+0000] {taskinstance.py:1157} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: k9_etl_dag_v6.prepare_sql manual__2024-09-03T14:13:52.121791+00:00 [queued]>
[2024-09-03T14:13:59.577+0000] {taskinstance.py:1157} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: k9_etl_dag_v6.prepare_sql manual__2024-09-03T14:13:52.121791+00:00 [queued]>
[2024-09-03T14:13:59.577+0000] {taskinstance.py:1359} INFO - Starting attempt 1 of 1
[2024-09-03T14:13:59.588+0000] {taskinstance.py:1380} INFO - Executing <Task(_PythonDecoratedOperator): prepare_sql> on 2024-09-03 14:13:52.121791+00:00
[2024-09-03T14:13:59.595+0000] {standard_task_runner.py:57} INFO - Started process 2408 to run task
[2024-09-03T14:13:59.598+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'k9_etl_dag_v6', 'prepare_sql', 'manual__2024-09-03T14:13:52.121791+00:00', '--job-id', '116', '--raw', '--subdir', 'DAGS_FOLDER/k9_etl_dag_v6.py', '--cfg-path', '/tmp/tmp9rww4qwk']
[2024-09-03T14:13:59.599+0000] {standard_task_runner.py:85} INFO - Job 116: Subtask prepare_sql
[2024-09-03T14:13:59.634+0000] {task_command.py:415} INFO - Running <TaskInstance: k9_etl_dag_v6.prepare_sql manual__2024-09-03T14:13:52.121791+00:00 [running]> on host 2624bebdd8ee
[2024-09-03T14:13:59.708+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='k9_etl_dag_v6' AIRFLOW_CTX_TASK_ID='prepare_sql' AIRFLOW_CTX_EXECUTION_DATE='2024-09-03T14:13:52.121791+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-09-03T14:13:52.121791+00:00'
[2024-09-03T14:13:59.710+0000] {python.py:194} INFO - Done. Returned value was: ['SELECT COALESCE(MAX(version), 0) FROM k9_facts_v6;', 'SELECT fact_id FROM k9_facts_v6 WHERE is_current = TRUE;', '\n            WITH current_data AS (\n                SELECT version, is_deleted\n                FROM k9_facts_v6\n                WHERE fact_id = \'f8d7b346e3b1b8d5155886cc0c0eb9e6\'::varchar AND is_current = TRUE\n            ),\n            update_existing AS (\n                UPDATE k9_facts_v6\n                SET is_current = FALSE\n                WHERE fact_id = \'f8d7b346e3b1b8d5155886cc0c0eb9e6\'::varchar AND is_current = TRUE\n                RETURNING 1\n            )\n            INSERT INTO k9_facts_v6 (fact_id, created_date, description, category, version, is_current, is_deleted)\n            SELECT \n                \'f8d7b346e3b1b8d5155886cc0c0eb9e6\'::varchar,\n                \'2023-10-02T02:22:00.272Z\'::timestamp,\n                \'Here\'\'s looking at you. Dogs have three eyelids, an upper lid, a lower lid and the third lid, called a nictitating membrane or "haw," which helps keep the eye moist and protected.\'::text,\n                \'without_numbers\'::varchar,\n                CASE \n                    WHEN NOT EXISTS (SELECT 1 FROM current_data) THEN \n                        CASE \n                            WHEN (SELECT COUNT(*) FROM k9_facts_v6) = 0 THEN 1\n                            ELSE (SELECT MAX(version) FROM k9_facts_v6 WHERE is_current = TRUE)\n                        END\n                    ELSE (SELECT version FROM current_data)\n                END,\n                TRUE,\n                FALSE\n            WHERE \n                NOT EXISTS (SELECT 1 FROM current_data WHERE is_deleted = FALSE)\n                OR EXISTS (SELECT 1 FROM update_existing);\n            ', "\n            WITH current_data AS (\n                SELECT version, is_deleted\n                FROM k9_facts_v6\n                WHERE fact_id = 'c7b94ca730f83ee56de8485b770d142d'::varchar AND is_current = TRUE\n            ),\n            update_existing AS (\n                UPDATE k9_facts_v6\n                SET is_current = FALSE\n                WHERE fact_id = 'c7b94ca730f83ee56de8485b770d142d'::varchar AND is_current = TRUE\n                RETURNING 1\n            )\n            INSERT INTO k9_facts_v6 (fact_id, created_date, description, category, version, is_current, is_deleted)\n            SELECT \n                'c7b94ca730f83ee56de8485b770d142d'::varchar,\n                '2024-05-12T08:17:49.657Z'::timestamp,\n                'Dogs are direct descendants of wolves.'::text,\n                'without_numbers'::varchar,\n                CASE \n                    WHEN NOT EXISTS (SELECT 1 FROM current_data) THEN \n                        CASE \n                            WHEN (SELECT COUNT(*) FROM k9_facts_v6) = 0 THEN 1\n                            ELSE (SELECT MAX(version) FROM k9_facts_v6 WHERE is_current = TRUE)\n                        END\n                    ELSE (SELECT version FROM current_data)\n                END,\n                TRUE,\n                FALSE\n            WHERE \n                NOT EXISTS (SELECT 1 FROM current_data WHERE is_deleted = FALSE)\n                OR EXISTS (SELECT 1 FROM update_existing);\n            ", "\n            WITH current_data AS (\n                SELECT version, is_deleted\n                FROM k9_facts_v6\n                WHERE fact_id = '07156b8c9f623ad5136ff319468849ae'::varchar AND is_current = TRUE\n            ),\n            update_existing AS (\n                UPDATE k9_facts_v6\n                SET is_current = FALSE\n                WHERE fact_id = '07156b8c9f623ad5136ff319468849ae'::varchar AND is_current = TRUE\n                RETURNING 1\n            )\n            INSERT INTO k9_facts_v6 (fact_id, created_date, description, category, version, is_current, is_deleted)\n            SELECT \n                '07156b8c9f623ad5136ff319468849ae'::varchar,\n                '2024-07-11T22:49:15.819Z'::timestamp,\n                'Dachshunds were originally bred for fighting badgers.'::text,\n                'without_numbers'::varchar,\n                CASE \n                    WHEN NOT EXISTS (SELECT 1 FROM current_data) THEN \n                        CASE \n                            WHEN (SELECT COUNT(*) FROM k9_facts_v6) = 0 THEN 1\n                            ELSE (SELECT MAX(version) FROM k9_facts_v6 WHERE is_current = TRUE)\n                        END\n                    ELSE (SELECT version FROM current_data)\n                END,\n                TRUE,\n                FALSE\n            WHERE \n                NOT EXISTS (SELECT 1 FROM current_data WHERE is_deleted = FALSE)\n                OR EXISTS (SELECT 1 FROM update_existing);\n            ", "\n            WITH current_data AS (\n                SELECT version, is_deleted\n                FROM k9_facts_v6\n                WHERE fact_id = '5930a3ebb7adbf803416fb4164cbf78b'::varchar AND is_current = TRUE\n            ),\n            update_existing AS (\n                UPDATE k9_facts_v6\n                SET is_current = FALSE\n                WHERE fact_id = '5930a3ebb7adbf803416fb4164cbf78b'::varchar AND is_current = TRUE\n                RETURNING 1\n            )\n            INSERT INTO k9_facts_v6 (fact_id, created_date, description, category, version, is_current, is_deleted)\n            SELECT \n                '5930a3ebb7adbf803416fb4164cbf78b'::varchar,\n                '2024-02-13T12:17:10.103Z'::timestamp,\n                'The Chihuahua was named after the state in Mexico where they were discovered.'::text,\n                'without_numbers'::varchar,\n                CASE \n                    WHEN NOT EXISTS (SELECT 1 FROM current_data) THEN \n                        CASE \n                            WHEN (SELECT COUNT(*) FROM k9_facts_v6) = 0 THEN 1\n                            ELSE (SELECT MAX(version) FROM k9_facts_v6 WHERE is_current = TRUE)\n                        END\n                    ELSE (SELECT version FROM current_data)\n                END,\n                TRUE,\n                FALSE\n            WHERE \n                NOT EXISTS (SELECT 1 FROM current_data WHERE is_deleted = FALSE)\n                OR EXISTS (SELECT 1 FROM update_existing);\n            ", "\n            WITH current_data AS (\n                SELECT version, is_deleted\n                FROM k9_facts_v6\n                WHERE fact_id = '8ce157d235d1777a5b50d45cd7df0f19'::varchar AND is_current = TRUE\n            ),\n            update_existing AS (\n                UPDATE k9_facts_v6\n                SET is_current = FALSE\n                WHERE fact_id = '8ce157d235d1777a5b50d45cd7df0f19'::varchar AND is_current = TRUE\n                RETURNING 1\n            )\n            INSERT INTO k9_facts_v6 (fact_id, created_date, description, category, version, is_current, is_deleted)\n            SELECT \n                '8ce157d235d1777a5b50d45cd7df0f19'::varchar,\n                '2023-10-21T13:42:31.896Z'::timestamp,\n                'The earliest dog fossil dates back to nearly 10,000 B.C.'::text,\n                'with_numbers'::varchar,\n                CASE \n                    WHEN NOT EXISTS (SELECT 1 FROM current_data) THEN \n                        CASE \n                            WHEN (SELECT COUNT(*) FROM k9_facts_v6) = 0 THEN 1\n                            ELSE (SELECT MAX(version) FROM k9_facts_v6 WHERE is_current = TRUE)\n                        END\n                    ELSE (SELECT version FROM current_data)\n                END,\n                TRUE,\n                FALSE\n            WHERE \n                NOT EXISTS (SELECT 1 FROM current_data WHERE is_deleted = FALSE)\n                OR EXISTS (SELECT 1 FROM update_existing);\n            ", "\n            WITH current_data AS (\n                SELECT version, is_deleted\n                FROM k9_facts_v6\n                WHERE fact_id = 'b1773808cf025d69c2fc912bf949f75b'::varchar AND is_current = TRUE\n            ),\n            update_existing AS (\n                UPDATE k9_facts_v6\n                SET is_current = FALSE\n                WHERE fact_id = 'b1773808cf025d69c2fc912bf949f75b'::varchar AND is_current = TRUE\n                RETURNING 1\n            )\n            INSERT INTO k9_facts_v6 (fact_id, created_date, description, category, version, is_current, is_deleted)\n            SELECT \n                'b1773808cf025d69c2fc912bf949f75b'::varchar,\n                '2023-08-05T22:31:44.473Z'::timestamp,\n                'Dogs can smell about 1,000 times better than humans. While humans have 5 million smell-detecting cells, dogs have more than 220 million. The part of the brain that interprets smell is also four times larger in dogs than in humans.'::text,\n                'with_numbers'::varchar,\n                CASE \n                    WHEN NOT EXISTS (SELECT 1 FROM current_data) THEN \n                        CASE \n                            WHEN (SELECT COUNT(*) FROM k9_facts_v6) = 0 THEN 1\n                            ELSE (SELECT MAX(version) FROM k9_facts_v6 WHERE is_current = TRUE)\n                        END\n                    ELSE (SELECT version FROM current_data)\n                END,\n                TRUE,\n                FALSE\n            WHERE \n                NOT EXISTS (SELECT 1 FROM current_data WHERE is_deleted = FALSE)\n                OR EXISTS (SELECT 1 FROM update_existing);\n            ", "\n            WITH current_data AS (\n                SELECT version, is_deleted\n                FROM k9_facts_v6\n                WHERE fact_id = '0092ec603e9497120e479ec0a13ab46a'::varchar AND is_current = TRUE\n            ),\n            update_existing AS (\n                UPDATE k9_facts_v6\n                SET is_current = FALSE\n                WHERE fact_id = '0092ec603e9497120e479ec0a13ab46a'::varchar AND is_current = TRUE\n                RETURNING 1\n            )\n            INSERT INTO k9_facts_v6 (fact_id, created_date, description, category, version, is_current, is_deleted)\n            SELECT \n                '0092ec603e9497120e479ec0a13ab46a'::varchar,\n                '2024-04-30T09:51:12.862Z'::timestamp,\n                'Dogs who bark the most: Miniature Schnauzers, Cairn Terriers, Yorkshire Terriers, Fox Terriers and West Highland White Terriers.'::text,\n                'without_numbers'::varchar,\n                CASE \n                    WHEN NOT EXISTS (SELECT 1 FROM current_data) THEN \n                        CASE \n                            WHEN (SELECT COUNT(*) FROM k9_facts_v6) = 0 THEN 1\n                            ELSE (SELECT MAX(version) FROM k9_facts_v6 WHERE is_current = TRUE)\n                        END\n                    ELSE (SELECT version FROM current_data)\n                END,\n                TRUE,\n                FALSE\n            WHERE \n                NOT EXISTS (SELECT 1 FROM current_data WHERE is_deleted = FALSE)\n                OR EXISTS (SELECT 1 FROM update_existing);\n            ", "\n            WITH current_data AS (\n                SELECT version, is_deleted\n                FROM k9_facts_v6\n                WHERE fact_id = 'a3a13d4a42d3f8e6bf1cd972a08e7609'::varchar AND is_current = TRUE\n            ),\n            update_existing AS (\n                UPDATE k9_facts_v6\n                SET is_current = FALSE\n                WHERE fact_id = 'a3a13d4a42d3f8e6bf1cd972a08e7609'::varchar AND is_current = TRUE\n                RETURNING 1\n            )\n            INSERT INTO k9_facts_v6 (fact_id, created_date, description, category, version, is_current, is_deleted)\n            SELECT \n                'a3a13d4a42d3f8e6bf1cd972a08e7609'::varchar,\n                '2024-03-13T11:07:45.588Z'::timestamp,\n                'Dogs can count up to five and can perform simple mathematical calculations.'::text,\n                'without_numbers'::varchar,\n                CASE \n                    WHEN NOT EXISTS (SELECT 1 FROM current_data) THEN \n                        CASE \n                            WHEN (SELECT COUNT(*) FROM k9_facts_v6) = 0 THEN 1\n                            ELSE (SELECT MAX(version) FROM k9_facts_v6 WHERE is_current = TRUE)\n                        END\n                    ELSE (SELECT version FROM current_data)\n                END,\n                TRUE,\n                FALSE\n            WHERE \n                NOT EXISTS (SELECT 1 FROM current_data WHERE is_deleted = FALSE)\n                OR EXISTS (SELECT 1 FROM update_existing);\n            ", '\n            WITH current_data AS (\n                SELECT version, is_deleted\n                FROM k9_facts_v6\n                WHERE fact_id = \'16b5a3eb00dcfb23fe1a7959bd6d602a\'::varchar AND is_current = TRUE\n            ),\n            update_existing AS (\n                UPDATE k9_facts_v6\n                SET is_current = FALSE\n                WHERE fact_id = \'16b5a3eb00dcfb23fe1a7959bd6d602a\'::varchar AND is_current = TRUE\n                RETURNING 1\n            )\n            INSERT INTO k9_facts_v6 (fact_id, created_date, description, category, version, is_current, is_deleted)\n            SELECT \n                \'16b5a3eb00dcfb23fe1a7959bd6d602a\'::varchar,\n                \'2024-04-14T00:25:43.063Z\'::timestamp,\n                \'Dogs belong to a biological family called the Canidae, a member of this family is called a canid. This is the origin of the adjective "canine" which means "of or like a dog, relating to or characteristic of dogs".\'::text,\n                \'without_numbers\'::varchar,\n                CASE \n                    WHEN NOT EXISTS (SELECT 1 FROM current_data) THEN \n                        CASE \n                            WHEN (SELECT COUNT(*) FROM k9_facts_v6) = 0 THEN 1\n                            ELSE (SELECT MAX(version) FROM k9_facts_v6 WHERE is_current = TRUE)\n                        END\n                    ELSE (SELECT version FROM current_data)\n                END,\n                TRUE,\n                FALSE\n            WHERE \n                NOT EXISTS (SELECT 1 FROM current_data WHERE is_deleted = FALSE)\n                OR EXISTS (SELECT 1 FROM update_existing);\n            ', "\n            WITH current_data AS (\n                SELECT version, is_deleted\n                FROM k9_facts_v6\n                WHERE fact_id = 'ae82383359496ce48425ffbf534be4b0'::varchar AND is_current = TRUE\n            ),\n            update_existing AS (\n                UPDATE k9_facts_v6\n                SET is_current = FALSE\n                WHERE fact_id = 'ae82383359496ce48425ffbf534be4b0'::varchar AND is_current = TRUE\n                RETURNING 1\n            )\n            INSERT INTO k9_facts_v6 (fact_id, created_date, description, category, version, is_current, is_deleted)\n            SELECT \n                'ae82383359496ce48425ffbf534be4b0'::varchar,\n                '2023-08-03T00:57:14.917Z'::timestamp,\n                'The border collie or sheep dog is often considered to be the most intelligent breed of dog some of them have been trained to recognize the words for up to 1,000 objects and retrieved them by verbal command.'::text,\n                'with_numbers'::varchar,\n                CASE \n                    WHEN NOT EXISTS (SELECT 1 FROM current_data) THEN \n                        CASE \n                            WHEN (SELECT COUNT(*) FROM k9_facts_v6) = 0 THEN 1\n                            ELSE (SELECT MAX(version) FROM k9_facts_v6 WHERE is_current = TRUE)\n                        END\n                    ELSE (SELECT version FROM current_data)\n                END,\n                TRUE,\n                FALSE\n            WHERE \n                NOT EXISTS (SELECT 1 FROM current_data WHERE is_deleted = FALSE)\n                OR EXISTS (SELECT 1 FROM update_existing);\n            ", "\n            WITH current_data AS (\n                SELECT version, is_deleted\n                FROM k9_facts_v6\n                WHERE fact_id = 'e7c5b4b91ba91d210948e005d91bd4ef'::varchar AND is_current = TRUE\n            ),\n            update_existing AS (\n                UPDATE k9_facts_v6\n                SET is_current = FALSE\n                WHERE fact_id = 'e7c5b4b91ba91d210948e005d91bd4ef'::varchar AND is_current = TRUE\n                RETURNING 1\n            )\n            INSERT INTO k9_facts_v6 (fact_id, created_date, description, category, version, is_current, is_deleted)\n            SELECT \n                'e7c5b4b91ba91d210948e005d91bd4ef'::varchar,\n                '2023-12-06T06:04:37.129Z'::timestamp,\n                'A dog''s heart beats up to 120 times per minute, or 50 faster than the average human heartbeat of 80 times per minute'::text,\n                'with_numbers'::varchar,\n                CASE \n                    WHEN NOT EXISTS (SELECT 1 FROM current_data) THEN \n                        CASE \n                            WHEN (SELECT COUNT(*) FROM k9_facts_v6) = 0 THEN 1\n                            ELSE (SELECT MAX(version) FROM k9_facts_v6 WHERE is_current = TRUE)\n                        END\n                    ELSE (SELECT version FROM current_data)\n                END,\n                TRUE,\n                FALSE\n            WHERE \n                NOT EXISTS (SELECT 1 FROM current_data WHERE is_deleted = FALSE)\n                OR EXISTS (SELECT 1 FROM update_existing);\n            ", '\n            WITH current_data AS (\n                SELECT version, is_deleted\n                FROM k9_facts_v6\n                WHERE fact_id = \'6b55818c65307027f8a5029f43eb217f\'::varchar AND is_current = TRUE\n            ),\n            update_existing AS (\n                UPDATE k9_facts_v6\n                SET is_current = FALSE\n                WHERE fact_id = \'6b55818c65307027f8a5029f43eb217f\'::varchar AND is_current = TRUE\n                RETURNING 1\n            )\n            INSERT INTO k9_facts_v6 (fact_id, created_date, description, category, version, is_current, is_deleted)\n            SELECT \n                \'6b55818c65307027f8a5029f43eb217f\'::varchar,\n                \'2024-05-19T05:23:03.498Z\'::timestamp,\n                \'In ancient Greece, kennels of dogs were kept at the sanctuary of Asclepius at Epidaurus. Dogs were frequently sacrificed there because they were plentiful, inexpensive, and easy to control. During the July 25 celebration of the kunophontis "the massacre of dogs", dog sacrifices were performed to appease the ancestors of Apollo\'\'s son, Linos, who was devoured by dogs..\'::text,\n                \'with_numbers\'::varchar,\n                CASE \n                    WHEN NOT EXISTS (SELECT 1 FROM current_data) THEN \n                        CASE \n                            WHEN (SELECT COUNT(*) FROM k9_facts_v6) = 0 THEN 1\n                            ELSE (SELECT MAX(version) FROM k9_facts_v6 WHERE is_current = TRUE)\n                        END\n                    ELSE (SELECT version FROM current_data)\n                END,\n                TRUE,\n                FALSE\n            WHERE \n                NOT EXISTS (SELECT 1 FROM current_data WHERE is_deleted = FALSE)\n                OR EXISTS (SELECT 1 FROM update_existing);\n            ', "\n            WITH current_data AS (\n                SELECT version, is_deleted\n                FROM k9_facts_v6\n                WHERE fact_id = '25e0edf775c11a4e1ae37dfcfae3d645'::varchar AND is_current = TRUE\n            ),\n            update_existing AS (\n                UPDATE k9_facts_v6\n                SET is_current = FALSE\n                WHERE fact_id = '25e0edf775c11a4e1ae37dfcfae3d645'::varchar AND is_current = TRUE\n                RETURNING 1\n            )\n            INSERT INTO k9_facts_v6 (fact_id, created_date, description, category, version, is_current, is_deleted)\n            SELECT \n                '25e0edf775c11a4e1ae37dfcfae3d645'::varchar,\n                '2023-09-02T07:09:10.585Z'::timestamp,\n                'Dalmatians are completely white at birth.'::text,\n                'without_numbers'::varchar,\n                CASE \n                    WHEN NOT EXISTS (SELECT 1 FROM current_data) THEN \n                        CASE \n                            WHEN (SELECT COUNT(*) FROM k9_facts_v6) = 0 THEN 1\n                            ELSE (SELECT MAX(version) FROM k9_facts_v6 WHERE is_current = TRUE)\n                        END\n                    ELSE (SELECT version FROM current_data)\n                END,\n                TRUE,\n                FALSE\n            WHERE \n                NOT EXISTS (SELECT 1 FROM current_data WHERE is_deleted = FALSE)\n                OR EXISTS (SELECT 1 FROM update_existing);\n            ", "\n            WITH current_data AS (\n                SELECT version, is_deleted\n                FROM k9_facts_v6\n                WHERE fact_id = '7c0b485a9122e68779e12fdb5526475c'::varchar AND is_current = TRUE\n            ),\n            update_existing AS (\n                UPDATE k9_facts_v6\n                SET is_current = FALSE\n                WHERE fact_id = '7c0b485a9122e68779e12fdb5526475c'::varchar AND is_current = TRUE\n                RETURNING 1\n            )\n            INSERT INTO k9_facts_v6 (fact_id, created_date, description, category, version, is_current, is_deleted)\n            SELECT \n                '7c0b485a9122e68779e12fdb5526475c'::varchar,\n                '2024-01-23T12:12:15.140Z'::timestamp,\n                'Dogs have twice as many muscles to move their ears as people.'::text,\n                'without_numbers'::varchar,\n                CASE \n                    WHEN NOT EXISTS (SELECT 1 FROM current_data) THEN \n                        CASE \n                            WHEN (SELECT COUNT(*) FROM k9_facts_v6) = 0 THEN 1\n                            ELSE (SELECT MAX(version) FROM k9_facts_v6 WHERE is_current = TRUE)\n                        END\n                    ELSE (SELECT version FROM current_data)\n                END,\n                TRUE,\n                FALSE\n            WHERE \n                NOT EXISTS (SELECT 1 FROM current_data WHERE is_deleted = FALSE)\n                OR EXISTS (SELECT 1 FROM update_existing);\n            ", "\n            WITH current_data AS (\n                SELECT version, is_deleted\n                FROM k9_facts_v6\n                WHERE fact_id = 'e543a6aa01b8679d94d40f81522c14f8'::varchar AND is_current = TRUE\n            ),\n            update_existing AS (\n                UPDATE k9_facts_v6\n                SET is_current = FALSE\n                WHERE fact_id = 'e543a6aa01b8679d94d40f81522c14f8'::varchar AND is_current = TRUE\n                RETURNING 1\n            )\n            INSERT INTO k9_facts_v6 (fact_id, created_date, description, category, version, is_current, is_deleted)\n            SELECT \n                'e543a6aa01b8679d94d40f81522c14f8'::varchar,\n                '2023-11-14T19:59:10.681Z'::timestamp,\n                'A one year old dog is as physically mature as a 15 year old human.'::text,\n                'with_numbers'::varchar,\n                CASE \n                    WHEN NOT EXISTS (SELECT 1 FROM current_data) THEN \n                        CASE \n                            WHEN (SELECT COUNT(*) FROM k9_facts_v6) = 0 THEN 1\n                            ELSE (SELECT MAX(version) FROM k9_facts_v6 WHERE is_current = TRUE)\n                        END\n                    ELSE (SELECT version FROM current_data)\n                END,\n                TRUE,\n                FALSE\n            WHERE \n                NOT EXISTS (SELECT 1 FROM current_data WHERE is_deleted = FALSE)\n                OR EXISTS (SELECT 1 FROM update_existing);\n            ", '\n            WITH current_data AS (\n                SELECT version, is_deleted\n                FROM k9_facts_v6\n                WHERE fact_id = \'6e3300b352959ff1ee472d5a7028ec24\'::varchar AND is_current = TRUE\n            ),\n            update_existing AS (\n                UPDATE k9_facts_v6\n                SET is_current = FALSE\n                WHERE fact_id = \'6e3300b352959ff1ee472d5a7028ec24\'::varchar AND is_current = TRUE\n                RETURNING 1\n            )\n            INSERT INTO k9_facts_v6 (fact_id, created_date, description, category, version, is_current, is_deleted)\n            SELECT \n                \'6e3300b352959ff1ee472d5a7028ec24\'::varchar,\n                \'2024-06-26T11:29:58.618Z\'::timestamp,\n                \'Walt Disney\'\'s family dog -- named Sunnee -- was the inspiration behind "Lady and the Tramp."\'::text,\n                \'without_numbers\'::varchar,\n                CASE \n                    WHEN NOT EXISTS (SELECT 1 FROM current_data) THEN \n                        CASE \n                            WHEN (SELECT COUNT(*) FROM k9_facts_v6) = 0 THEN 1\n                            ELSE (SELECT MAX(version) FROM k9_facts_v6 WHERE is_current = TRUE)\n                        END\n                    ELSE (SELECT version FROM current_data)\n                END,\n                TRUE,\n                FALSE\n            WHERE \n                NOT EXISTS (SELECT 1 FROM current_data WHERE is_deleted = FALSE)\n                OR EXISTS (SELECT 1 FROM update_existing);\n            ']
[2024-09-03T14:13:59.725+0000] {taskinstance.py:1398} INFO - Marking task as SUCCESS. dag_id=k9_etl_dag_v6, task_id=prepare_sql, execution_date=20240903T141352, start_date=20240903T141359, end_date=20240903T141359
[2024-09-03T14:13:59.741+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 0
[2024-09-03T14:13:59.761+0000] {taskinstance.py:2776} INFO - 1 downstream tasks scheduled from follow-on schedule check
